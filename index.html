<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Focus Task Tracker v2.0</title>

<style>
:root{
  --bg:#000;
  --card:#0b0b0b;
  --border:#222;
  --text-dim:#9ca3af;
}
*{box-sizing:border-box}
html,body{width:100%;height:100%}
body{
  margin:0;
  font-family:Inter,Arial,sans-serif;
  background:
    radial-gradient(circle at 1px 1px,#111 1px,transparent 0) 0 0/24px 24px,
    var(--bg);
  color:#fff;
  display:flex;
}

/* SOUND TOGGLE */
.sound-toggle{
  position:fixed;
  top:14px;
  right:16px;
  background:#000;
  border:1px solid #333;
  border-radius:12px;
  padding:8px 10px;
  cursor:pointer;
  font-size:18px;
}

/* MESSAGE */
.message{
  position:fixed;
  top:60px;
  right:16px;
  background:#111;
  border:1px solid #444;
  padding:12px 16px;
  border-radius:12px;
  opacity:0;
  transform:translateY(-10px);
  transition:.3s;
}
.message.show{opacity:1;transform:translateY(0)}

.left{flex:1;display:flex;justify-content:center;align-items:center}
.right{
  width:360px;
  background:#020202;
  border-left:2px solid var(--border);
  padding:24px;
  overflow-y:auto;
}

/* CARD */
.card{
  width:420px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:32px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:22px;
}

/* STATS */
.stats{display:flex;gap:20px}
.stat{
  width:180px;
  height:140px;
  background:#000;
  border:1px solid #444;
  border-radius:18px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}
.stat-value{
  font-size:18px;
  font-weight:800;
  text-align:center;
  line-height:1.3;
}
.stat-label{font-size:13px;color:var(--text-dim)}

/* TIMER */
.timer-wrap{width:120px;height:120px}
.timer-ring{
  width:100%;height:100%;
  border-radius:50%;
  background:conic-gradient(#111 360deg,#111 0);
  border:1px solid #555;
  display:flex;
  justify-content:center;
  align-items:center;
}
.timer-inner{
  width:86px;height:86px;
  border-radius:50%;
  border:1px solid #444;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:26px;
  font-weight:700;
}

/* INPUTS */
input{
  width:100%;
  padding:12px;
  background:#000;
  border:1px solid var(--border);
  border-radius:10px;
  color:#fff;
  text-align:center;
}

/* BUTTONS */
button{
  padding:14px 22px;
  border-radius:14px;
  border:none;
  font-weight:600;
  color:#fff;
  cursor:pointer;
}
.start{background:#16a34a}
.pause{background:#ca8a04}
.stop{background:#dc2626}
.submit{background:#2563eb}
.undo{background:#4b5563}
.backup{background:#0ea5e9}

.button-row{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  justify-content:center;
}

/* LOG */
.task-group{padding:12px 0;border-bottom:1px solid #333}
.task-title{font-weight:600}
.task-count{font-size:13px;color:var(--text-dim)}

.backup-section{
  margin-top:24px;
  padding-top:16px;
  border-top:1px solid #333;
}
</style>
</head>

<body>

<div class="sound-toggle" id="soundBtn" onclick="toggleSound()">üîî</div>
<div class="message" id="msg">‚è∞ Time‚Äôs up! Task auto-submitted</div>

<div class="left">
  <div class="card">

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="count">0</div>
        <div class="stat-label">Total Tasks</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="totalTime">0 min 0 sec</div>
        <div class="stat-label">Total Time</div>
      </div>
    </div>

    <div class="timer-wrap">
      <div class="timer-ring" id="ring">
        <div class="timer-inner" id="timer">00:00</div>
      </div>
    </div>

    <input id="taskName" list="taskList" placeholder="Task name">
    <datalist id="taskList"></datalist>

    <input id="timeInput" type="number" placeholder="Time in minutes">

    <div class="button-row">
      <button class="start" onclick="startTimer()">Start</button>
      <button class="pause" id="pauseBtn" onclick="togglePause()">‚è∏ Pause</button>
      <button class="stop" onclick="stopTimer()">Stop</button>
    </div>

    <div class="button-row">
      <button class="submit" onclick="submitTask()">+1 Submit</button>
      <button class="undo" onclick="undoTask()">‚àí1 Undo</button>
    </div>

    <input id="manualTime" type="number" placeholder="Add past time (minutes)">
    <div class="button-row">
      <button class="backup" onclick="addManualTime()">‚ûï Add Time</button>
    </div>

  </div>
</div>

<div class="right">
  <h3>Task Log</h3>
  <div id="taskLog"></div>

  <div class="backup-section">
    <button class="backup" onclick="downloadLog()">Download Backup</button>
    <input type="file" accept=".txt" onchange="loadLog(event)">
  </div>
</div>

<audio id="alarm" src="iphone_alarm.mp3" loop preload="auto"></audio>

<script>
/* ===== STATE ===== */
let totalCount=0, totalTimeSpent=0;
let startTime=null, endTime=null, durationSec=0;
let tickInterval=null;
let soundOn=true;
let remainingSec=0;
const alarm=document.getElementById("alarm");
const tasks={};

/* ===== TASK AHT ===== */
const TASK_AHT={
  "251015-stationary-camera-transforms":15,
  "251102-image-facts":20,
  "251106-screenshot-code":5,
  "250917-ig-entity-tagging":30,
  "251107-image-edit-region":15,
  "250911-character-consistency":3,
  "251111-share-lm-chats":5,
  "250915-asr-transcript-accuracy":2,
  "251030-audio-transcript":8,
  "250907-ui-images":10,
  "250911-scene-expansion":3,
  "250915-product-image-pairs":5,
  "251112-hard-grounding-samples":7,
  "251112-text-elo-h2h":15,
  "251110-gauge-annotation":2,
  "251103-qr-code-extraction":2,
  "251014-ig-entity-tagging-videos":10,
  "251119-scripted-call-av-solo-client":10,
  "251121-aspect-ratio-cropping":5,
  "250922-engaging-videos":5,
  "250927-correct-counting":5,
  "082525-counting":5,
  "251122-person-isolation-bbox":12,
  "251101-website-generation":10,
  "251122-group-person-removal":15,
  "251112-image-translation":5,
  "251121-asr-transcript-accuracy-v2":2,
  "251119-add-perception-labels":10,
  "250925-create-task":20,
  "251101-artistic-style-reference":25,
  "251127-image-color-picker":25,
  "251125-count-verification":3,
  "251002-tripod-survey":1,
  "251211-transparent-background-images":4,
  "251216-text-to-audio-h2h":2,
  "251205-freeform-conversations":5,
  "Auto-execute-1766207105019":5,
  "250925-tripod-photos":5
};

Object.keys(TASK_AHT).forEach(t=>{
  const o=document.createElement("option");
  o.value=t;
  taskList.appendChild(o);
});

taskName.addEventListener("input",()=>{
  if(TASK_AHT[taskName.value]) timeInput.value=TASK_AHT[taskName.value];
});

/* ===== SOUND ===== */
function toggleSound(){
  soundOn=!soundOn;
  soundBtn.innerText=soundOn?"üîî":"üîï";
  stopAlarm();
}
function unlockAudio(){
  alarm.muted=true;
  alarm.play().then(()=>{
    alarm.pause();alarm.currentTime=0;alarm.muted=false;
  }).catch(()=>{});
}
function startAlarm(){ if(soundOn){ alarm.currentTime=0; alarm.play(); } }
function stopAlarm(){ alarm.pause(); alarm.currentTime=0; }

/* ===== FORMATTERS ===== */
function formatTime(sec){
  const m=Math.floor(sec/60),s=sec%60;
  return `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}
function formatTotalTime(sec){
  const h=Math.floor(sec/3600),
        m=Math.floor((sec%3600)/60),
        s=sec%60;
  return h>0?`${h} hr ${m} min ${s} sec`:`${m} min ${s} sec`;
}

/* ===== TIMER ===== */
function startTimer(){
  unlockAudio();
  if(tickInterval) return;

  if(remainingSec===0){
    const mins=Number(timeInput.value);
    if(!mins||mins<=0) return;
    remainingSec=mins*60;
    durationSec=remainingSec;
  }

  startTime=Date.now();
  endTime=startTime+remainingSec*1000;
  tick();
  tickInterval=setInterval(tick,1000);
  pauseBtn.innerText="‚è∏ Pause";
}

function togglePause(){
  if(tickInterval){
    clearInterval(tickInterval);
    tickInterval=null;
    pauseBtn.innerText="‚ñ∂ Play";
  }else if(remainingSec>0){
    startTimer();
    pauseBtn.innerText="‚è∏ Pause";
  }
}

function tick(){
  const remMs=endTime-Date.now();
  if(remMs<=0){
    clearInterval(tickInterval);
    tickInterval=null;
    remainingSec=0;
    timer.innerText="00:00";
    updateRing(0);
    startAlarm();
    autoSubmit();
    pauseBtn.innerText="‚è∏ Pause";
    return;
  }
  remainingSec=Math.ceil(remMs/1000);
  timer.innerText=formatTime(remainingSec);
  updateRing(remainingSec);
}

function stopTimer(){
  clearInterval(tickInterval);
  tickInterval=null;
  remainingSec=0;
  startTime=null;
  timer.innerText="00:00";
  ring.style.background="conic-gradient(#111 360deg,#111 0)";
  pauseBtn.innerText="‚è∏ Pause";
}

function updateRing(rem){
  if(!durationSec) return;
  ring.style.background=
    `conic-gradient(#2563eb ${(1-rem/durationSec)*360}deg,#111 0)`;
}

/* ===== TASKS ===== */
function ensureTask(t){
  if(tasks[t]) return;
  const g=document.createElement("div");
  g.className="task-group";
  g.innerHTML=`<div class="task-title">${t}</div><div class="task-count">Total done: 0</div>`;
  taskLog.prepend(g);
  tasks[t]={count:0,countEl:g.children[1]};
}
function autoSubmit(){ submitTask(true); showMessage(); stopAlarm(); }

function submitTask(auto=false){
  const t=taskName.value||"Unnamed Task";
  ensureTask(t);
  totalCount++; tasks[t].count++;
  count.innerText=totalCount;
  tasks[t].countEl.innerText=`Total done: ${tasks[t].count}`;
  if(startTime){
    totalTimeSpent+=Math.round((Date.now()-startTime)/1000);
    totalTime.innerText=formatTotalTime(totalTimeSpent);
  }
  if(!auto) stopTimer();
  startTime=null;
  remainingSec=0;
  pauseBtn.innerText="‚è∏ Pause";
}

function addManualTime(){
  const mins=Number(manualTime.value);
  if(!mins||mins<=0) return;
  totalTimeSpent+=mins*60;
  totalTime.innerText=formatTotalTime(totalTimeSpent);
  manualTime.value="";
}

function undoTask(){
  const t=taskName.value||"Unnamed Task";
  if(!tasks[t]||tasks[t].count===0) return;
  totalCount--; tasks[t].count--;
  count.innerText=totalCount;
  tasks[t].countEl.innerText=`Total done: ${tasks[t].count}`;
}

/* ===== UI ===== */
function showMessage(){
  msg.classList.add("show");
  setTimeout(()=>msg.classList.remove("show"),3000);
}

/* ===== BACKUP ===== */
function downloadLog(){
  let txt=`TOTAL_TASKS:${totalCount}\nTOTAL_TIME:${totalTimeSpent}\n`;
  Object.keys(tasks).forEach(t=>txt+=`${t}:${tasks[t].count}\n`);
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([txt],{type:"text/plain"}));
  a.download="task_log_backup.txt";
  a.click();
}
function loadLog(e){
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=()=>{
    taskLog.innerHTML="";
    Object.keys(tasks).forEach(k=>delete tasks[k]);
    r.result.split("\n").forEach(l=>{
      if(!l.trim()) return;
      if(l.startsWith("TOTAL_TASKS")){
        totalCount=+l.split(":")[1];
        count.innerText=totalCount;
      }else if(l.startsWith("TOTAL_TIME")){
        totalTimeSpent=+l.split(":")[1];
        totalTime.innerText=formatTotalTime(totalTimeSpent);
      }else{
        const [t,c]=l.split(":");
        ensureTask(t);
        tasks[t].count=+c;
        tasks[t].countEl.innerText=`Total done: ${c}`;
      }
    });
  };
  r.readAsText(f);
}
</script>

</body>
</html>
